<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Page</title>
    {% load static %}
    {% load custom_filters %}
   <link rel="stylesheet" type="text/css" href="{% static 'profile.css' %}">
</head>
<body>

<header>
    <a href="{% url 'mainPage' %}" class="back-btn">Back</a>
    <h1>What’s for Dinner?</h1>
    <a href="{% url 'login' %}"> <button class="register-btn">Sign in</button></a>

</header>

<div class="container">
   <!-- <h2 class="text-center mb-4">My Profile</h2> -->

    <!-- Tabs Navigation -->
    <div class="tabs">
        <button class="tab-button active" data-tab="my-profile">My Profile</button>
        <button class="tab-button" data-tab="favorite-recipes">Favorite Recipes</button>
        <button class="tab-button" data-tab="my-recipes">My Recipes</button>
        <form method="post" action="{% url 'logout' %}">
    {% csrf_token %}
    <button type="submit" class="register-btn">Log Out</button>
</form>


    </div>

    <!-- Tab Contents -->
    <div id="my-profile" class="tab-content active">
        <div>
         {% if user.profile.photo %}
                <img src="{{ user.profile.photo.url }}" alt="Profile Picture" class="profile-picture">
            {% else %}
                <img src="{% static 'default-profile.png' %}" alt="Default Profile Picture" class="profile-picture">
            {% endif %}
            <h2 class="username">{{ user.username }}</h2>
            <p class="email">{{ user.email }}</p>
        </div>
        <div class="profile-stats">
            <div class="stat">
                <strong>{{ user.recipes.count }}</strong>
                <p>My Recipes</p>
            </div>
            <div class="stat">
                <strong>{{ favorite_recipes.count }}</strong>
                <p>Favorites</p>
            </div>
        </div>
    </div>

   <div id="favorite-recipes" class="tab-content">
        <h3>Favorite Recipes</h3>
        {% if favorite_recipes %}
            <div class="card-container">
                {% for recipe in favorite_recipes %}
                    <div class="card">
                        <div class="card-content">
                            <div class="card-text">
                                <strong class="category">{{ recipe.category }}</strong>
                                <h3 class="title">{{ recipe.name }}</h3>
                                <p class="ingredients">{{ recipe.ingredients }}</p>
                                <p class="description">{{ recipe.instructions|truncatewords:20 }}</p>
                                <div class="recipe-card-footer">
                                    <a href="{% url 'recipe_detail' recipe.id %}" class="view-recipe-btn">
                                        View Full Recipe <span class="icon">→</span>
                                    </a>
                                     <form action="{% url 'remove_from_favorites' recipe.id %}" method="post" class="remove-form">
                                        {% csrf_token %}
                                        <button type="submit" class="remove-btn">×</button>
                                    </form>
                                </div>
                            </div>
                           <div class="image">
                                {% if recipe.image %}
                                    <img src="{{ recipe.image.url }}" alt="{{ recipe.name }}" width="200" height="250">
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>You have no favorite recipes yet.</p>
        {% endif %}
    </div>


    <div id="my-recipes" class="tab-content">
        <h3>My Recipes</h3>
        <p>Update your profile information and preferences here.</p>
    </div>
</div>

<script>
    // JavaScript to handle tab switching
    document.querySelectorAll('.tab-button').forEach(button => {
        button.addEventListener('click', () => {
            // Remove 'active' class from all buttons and contents
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Add 'active' class to the clicked button and corresponding content
            button.classList.add('active');
            document.getElementById(button.dataset.tab).classList.add('active');
        });
    });
</script>

</body>
</html>
