<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Page</title>
    {% load static %}
    {% load custom_filters %}
   <link rel="stylesheet" type="text/css" href="{% static 'profile.css' %}">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

<header>
    <a href="{% url 'mainPage' %}" class="back-btn">Back</a>
    <h1>What’s for Dinner?</h1>


</header>

<div class="container">
   <!-- <h2 class="text-center mb-4">My Profile</h2> -->

    <!-- Tabs Navigation -->
    <div class="tabs">
        <button class="tab-button active" data-tab="my-profile">My Profile</button>
        <button class="tab-button" data-tab="favorite-recipes">Favorite Recipes</button>
        <button class="tab-button" data-tab="my-recipes">My Recipes</button>
        <button class="tab-button" data-tab="want-to-cook">Want to Cook</button>

        <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button type="submit" class="register-btn">Log Out</button>
        </form>


    </div>

    <!-- Tab Contents -->
    <div id="my-profile" class="tab-content active">
        <div class="profile-header">

            <img src="{{ user.profile.photo.url }}" alt="" class="profile-picture">

        <h2 class="username">{{ user.username }}</h2>
        <p class="email">{{ user.email }}</p>
        </div>

    <div class="profile-stats">
        <div class="stat">
        <i class="fas fa-book"></i>
        <strong>{{ user.recipes.count }}</strong>
        <p>My Recipes</p>
        </div>
        <div class="stat">
        <i class="fas fa-heart"></i>
        <strong>{{ favorite_recipes.count }}</strong>
        <p>Favorites</p>
     </div>
        <div class="stat">
        <i class="fas fa-utensils"></i>
        <strong>{{ want_to_cook_recipes.count }}</strong>
        <p>Want to Cook</p>
         </div>

    </div>
        </div>


   <div id="favorite-recipes" class="tab-content">
        <h3>Favorite Recipes</h3>
        {% if favorite_recipes %}
            <div class="card-container">
                {% for recipe in favorite_recipes %}
                    <div class="card">
                        <div class="card-content">
                            <div class="card-text">
                                <strong class="category">{{ recipe.category }}</strong>
                                <h3 class="title">{{ recipe.name }}</h3>
                                <p class="ingredients">{{ recipe.ingredients|truncatewords:20 }}</p>
                                <p class="description"><strong>Instructions:</strong>
                                        {% if recipe.instructions %}
                                            {% if recipe.instructions|length > 100 %}
                                                {{ recipe.instructions|truncatewords:20|safe }}
                                            {% else %}
                                                {{ recipe.instructions|truncatewords:20 }}
                                            {% endif %}
                                        {% else %}
                                            No instructions available.
                                        {% endif %}
                                    </p>
                                <div class="recipe-card-footer">
                                    <a href="{% url 'recipe_detail' recipe.id %}" class="view-recipe-btn">
                                        View Full Recipe <span class="icon">→</span>
                                    </a>
                                     <form action="{% url 'remove_from_favorites' recipe.id %}" method="post" class="remove-form">
                                        {% csrf_token %}
                                        <button type="submit" class="remove-btn">×</button>
                                    </form>


                                </div>
                            </div>
                           <div class="image">
                                {% if recipe.image_url %}
                                        <img src="{{ recipe.image_url }}" alt="{{ recipe.name }}" width="200" height="250">
                                    {% elif recipe.image %}
                                        <img src="{{ recipe.image.url }}" alt="{{ recipe.name }}" width="200" height="250">
                                    {% endif %}

                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>You have no favorite recipes yet.</p>
        {% endif %}
    </div>


    <div id="my-recipes" class="tab-content">
    <h3>My Recipes</h3>
    {% if my_recipes %}
        <div class="card-container">
            {% for recipe in my_recipes %}
                <div class="card">
                    <div class="card-content">
                        <div class="card-text">
                            <strong class="category">{{ recipe.category }}</strong>
                            <h3 class="title">{{ recipe.name }}</h3>
                            <p class="ingredients">{{ recipe.ingredients }}</p>
                            <p class="description"><strong>Instructions:</strong>
                                        {% if recipe.instructions %}
                                            {% if recipe.instructions|length > 100 %}
                                                {{ recipe.instructions|truncatewords:20|safe }}
                                            {% else %}
                                                {{ recipe.instructions|truncatewords:20 }}
                                            {% endif %}
                                        {% else %}
                                            No instructions available.
                                        {% endif %}
                                    </p>
                            <div class="recipe-card-footer">
                                <a href="{% url 'recipe_detail' recipe.id %}" class="view-recipe-btn">
                                    View Full Recipe <span class="icon">→</span>
                                </a>
                                <form action="{% url 'delete_recipe' recipe.id %}" method="post" class="remove-form">
                                    {% csrf_token %}
                                     {% csrf_token %}
                                        <button type="submit" class="remove-btn">×</button>
                                </form>
                            </div>
                        </div>
                        <div class="image">
                            {% if recipe.image %}
                                <img src="{{ recipe.image.url }}" alt="{{ recipe.name }}" width="200" height="250">
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>You haven't added any recipes yet.</p>
    {% endif %}
</div>

    <div id="want-to-cook" class="tab-content">
    <h3>Want to Cook Recipes</h3>
    {% if want_to_cook_recipes %}
        <div class="card-container">
            {% for recipe in want_to_cook_recipes %}
                <div class="card">
                    <div class="card-content">
                        <div class="card-text">
                            <strong class="category">{{ recipe.category }}</strong>
                            <h3 class="title">{{ recipe.name }}</h3>
                            <p class="ingredients">{{ recipe.ingredients|truncatewords:20 }}</p>
                            <p class="description"><strong>Instructions:</strong>
                                {% if recipe.instructions %}
                                    {% if recipe.instructions|length > 100 %}
                                        {{ recipe.instructions|truncatewords:20|safe }}
                                    {% else %}
                                        {{ recipe.instructions|truncatewords:20 }}
                                    {% endif %}
                                {% else %}
                                    No instructions available.
                                {% endif %}
                            </p>
                            <div class="recipe-card-footer">
                                <a href="{% url 'recipe_detail' recipe.id %}" class="view-recipe-btn">
                                    View Full Recipe <span class="icon">→</span>
                                </a>
                                <form action="{% url 'remove_from_want_to_cook' recipe.id %}" method="post" class="remove-form">
                                    {% csrf_token %}
                                    <button type="submit" class="remove-btn">×</button>
                                </form>
                            </div>
                        </div>
                        <div class="image">
                            {% if recipe.image_url %}
                                <img src="{{ recipe.image_url }}" alt="{{ recipe.name }}" width="200" height="250">
                            {% elif recipe.image %}
                                <img src="{{ recipe.image.url }}" alt="{{ recipe.name }}" width="200" height="250">
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>You have no recipes in your Want to Cook list yet.</p>
    {% endif %}


               <div id="shopping-list" class="tab-content">
    <h3>Shopping List</h3>
    {% if shopping_list %}
        <div class="shopping-list-container">
            <ul>
                {% for ingredient, quantity in shopping_list.items %}
                    <li>{{ ingredient }}: {{ quantity }}</li>
                {% endfor %}
            </ul>
        </div>
    {% else %}
        <p>You have no items in your shopping list.</p>
    {% endif %}
</div>




</div>


</div>

<script>
    // JavaScript to handle tab switching
    document.querySelectorAll('.tab-button').forEach(button => {
        button.addEventListener('click', () => {
            // Remove 'active' class from all buttons and contents
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Add 'active' class to the clicked button and corresponding content
            button.classList.add('active');
            document.getElementById(button.dataset.tab).classList.add('active');
        });
    });
</script>

</body>
</html>
